# @package _global_

# adapted from sbm.yaml
dataset:
    name: protein
    remove_h: null
    network_dir: 'data/ND-code-datasets/Application2-protein-contact-maps/full-predictions'
    force_reload: False
    norm: ND_norm

    eps: 1e-2 # only used in eigen norm and ND norm
    diffusion_steps: ${model.diffusion_steps} # only used in ND norm
    slope: 1 # only used in ND norm for changing slope of sigmoid
general:
    name : 'protein'
    gpus : [7]
    wandb: 'online'
    resume: null            # If resume, path to ckpt file from outputs directory in main directory
    test_only: null
    check_val_every_n_epochs: 10
    sample_every_val: 10000 # disable validation sampling, no need
    samples_to_generate: 5
    samples_to_save: 5
    chains_to_save: 1
    final_model_samples_to_generate: 0 # disable final sampling
    final_model_samples_to_save: 5
    final_model_chains_to_save: 5
    # NOTE(jiahang): new config
    save_chain_results: /home/jiahang/DiGress/chain_results/${now:%Y-%m-%d}/${now:%H-%M-%S}-${general.name}
    save_chain_every_steps: 2 # no need to save all steps
train:
    # n_epochs: 50000
    n_epochs: 100
    batch_size: 5
    save_model: True
model:
    # NOTE(jiahang): note the difference between model.slope and dataset.slope
    ## model.slope will be used in all slope_sigmoid for computing f(t)
    ## dataset.slope will be used in only computing q(G0)
    ## for simplification we let model.slope = dataset.slope
    slope: ${dataset.slope}
    transition: ND
    sample_forward: false # true is not supported yet!
    # diffusion_steps: 1000
    diffusion_steps: 20
    n_layers: 8
    lambda_train: [1, 0]
    extra_features: null
    pos_e_w: 1.0

    # Do not set hidden_mlp_E, dim_ffE too high, computing large tensors on the edges is costly
    # At the moment (03/08), y contains quite little information
    hidden_mlp_dims: { 'X': 128, 'E': 64, 'y': 128 }

    # The dimensions should satisfy dx % n_head == 0
    hidden_dims: { 'dx': 256, 'de': 64, 'dy': 64, 'n_head': 8, 'dim_ffX': 256, 'dim_ffE': 64, 'dim_ffy': 256 }